clc;clear all; close all;
load('D:\ChPrediction\H\QPSK\Testing_Simulation_variables.mat');
EbN0dB = 0:5:40;

BER_LSTM_DNN_DPA = [0.203115104166667;0.107567812500000;0.0369469791666667;0.00671958333333333;0.000867500000000000;0.000245208333333333;0.000221250000000000;0.000124375000000000;0.000122083333333333]
ERR_LSTM_DNN_DPA = [0.289057435275118;0.0889262930315367;0.0289326556320499;0.0102460680443538;0.00424305551883229;0.00233903962632650;0.00174406358719388;0.00155612167991720;0.00149545556813863]

BER_LSTM_DPA_TA = [0.194085312500000;0.0992953125000000;0.0328900000000000;0.00621864583333333;0.00104864583333333;0.000485416666666667;0.000408437500000000;0.000371979166666667;0.000348645833333333]
ERR_LSTM_DPA_TA = [0.182692499130497;0.0483717665663219;0.0154708936418625;0.00563096113912935;0.00254675635694122;0.00158596392487935;0.00127201675182819;0.00116808589602540;0.00114540196585890]


%BER_LSTM_DNN_DPA = [0.215701250000000;0.117823906250000;0.0335423437500000;0.00378770833333333;0.000461250000000000;0.000171927083333333;0.000134062500000000;0.000115104166666667;0.000112916666666667];
%BER_LSTM_DPA_TA = [0.203631354166667;0.102358489583333;0.0261790104166667;0.00311927083333333;0.000534687500000000;0.000302968750000000;0.000284322916666667;0.000264791666666667;0.000251458333333333];

%ERR_LSTM_DNN_DPA = [0.337840326711985;0.110069477349000;0.0371972135823450;0.0132269421475668;0.00538296668969561;0.00287040319110124;0.00207113833364385;0.00181758683899465;0.00173580469460009];
%ERR_LSTM_DPA_TA = [0.183270912274707;0.0466201236724358;0.0148354003926442;0.00594163707004178;0.00327761803805543;0.00246082210505616;0.00220444956256779;0.00211726733528706;0.00209317983941330];

% BER_LSTM_DNN_DPA = [0.205160416666667;0.110345312500000;0.0278703125000000;0.00334947916666667;0.000604166666666667;0.000289583333333333;0.000477604166666667;0.000336458333333333;0.000256770833333333];
% BER_LSTM_DPA_TA = [0.203527604166667;0.110015625000000;0.0332750000000000;0.00792968750000000;0.00364166666666667;0.00122604166666667;0.000858333333333333;0.000842708333333333;0.000871875000000000];
% 
% ERR_LSTM_DNN_DPA = [0.164814506569748;0.0510143399176452;0.0244154745284804;0.0171602528925951;0.0150665971312992;0.0144395310173462;0.0143193457966104;0.0142384346760484;0.0142123686097308]; 
% ERR_LSTM_DPA_TA = [0.136323696317025;0.0418360183644677;0.0219105523395088;0.0183346702488377;0.0152631779616445;0.0132316934574977;0.0132006969724709;0.0132275887463043;0.0132236935429881];

figure,
semilogy(EbN0dB, BER_Ideal,'k-o','LineWidth',2);
hold on;
semilogy(EbN0dB, BER_Initial,'g-o','LineWidth',2);
hold on;
semilogy(EbN0dB, BER_DPA_TA,'m-o','LineWidth',2);
hold on;
semilogy(EbN0dB, BER_LSTM_DNN_DPA,'r--o','LineWidth',2);
hold on;
semilogy(EbN0dB, BER_LSTM_DPA_TA,'c--o','LineWidth',2);
hold on;
grid on;
legend('Perfect Channel','DPA','DPA-TA','LSTM-DNN-DPA','LSTM-DPA-TA');
xlabel('SNR(dB)');
% ylim([[3.81875000000000e-05] 10^0])
ylabel('Bit Error Rate (BER)');

figure,
semilogy(EbN0dB, ERR_Initial,'g-o','LineWidth',2);
hold on;
semilogy(EbN0dB, ERR_DPA_TA,'m-o','LineWidth',2);
hold on;
semilogy(EbN0dB, ERR_LSTM_DNN_DPA,'r--o','LineWidth',2);
hold on;
semilogy(EbN0dB, ERR_LSTM_DPA_TA,'c--o','LineWidth',2);
hold on;
grid on;
legend('DPA','DPA-TA','LSTM-DNN-DPA','LSTM-DPA-TA');
xlabel('SNR(dB)');
ylabel('Normalized Mean Sqaure Error (NMSE)');
